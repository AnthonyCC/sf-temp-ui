DROP TABLE ERPS.ATTRIBUTES_SALES_AREA CASCADE CONSTRAINTS;

CREATE MATERIALIZED VIEW ERPS.ATTRIBUTES_SALES_AREA 
ON PREBUILT TABLE WITH REDUCED PRECISION
USING INDEX
            TABLESPACE FDERPDAT
            PCTFREE    10
            INITRANS   2
            MAXTRANS   255
            STORAGE    (
                        INITIAL          64K
                        MINEXTENTS       1
                        MAXEXTENTS       UNLIMITED
                        PCTINCREASE      0
                        BUFFER_POOL      DEFAULT
                       )
REFRESH FAST
START WITH SYSDATE
NEXT sysdate + 2/24
WITH PRIMARY KEY
AS 
SELECT "ATTRIBUTES_SALES_AREA"."ID" "ID",
       "ATTRIBUTES_SALES_AREA"."SKUCODE" "SKUCODE",
       "ATTRIBUTES_SALES_AREA"."SALES_ORG" "SALES_ORG",
       "ATTRIBUTES_SALES_AREA"."DISTRIBUTION_CHANNEL" "DISTRIBUTION_CHANNEL",
       "ATTRIBUTES_SALES_AREA"."ATR_TYPE" "ATR_TYPE",
       "ATTRIBUTES_SALES_AREA"."ATR_NAME" "ATR_NAME",
       "ATTRIBUTES_SALES_AREA"."ATR_VALUE" "ATR_VALUE",
       "ATTRIBUTES_SALES_AREA"."DATE_MODIFIED" "DATE_MODIFIED"
  FROM "ERPS"."ATTRIBUTES_SALES_AREA"@DBSTG.NYC.FRESHDIRECT.COM "ATTRIBUTES_SALES_AREA";

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO APPDEV_ROLE;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO CSSI;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO DWHUSER_ROLE;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO DWUSER;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO FDETLRO;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO FDSTORE_PRDA;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO FDSTORE_PRDB;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO FDSTORE_STPRD01;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO MYLES;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO RO_CUST_ERPS;

GRANT SELECT ON ERPS.ATTRIBUTES_SALES_AREA TO STORE_READ;


CREATE INDEX ERPS.IDX_ATTRIBUTES_SALES_AREA ON ERPS.ATTRIBUTES_SALES_AREA
(SKUCODE, SALES_ORG, DISTRIBUTION_CHANNEL)
LOGGING
TABLESPACE FDERPDAT
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
NOPARALLEL
COMPRESS 1;
