CREATE PUBLIC DATABASE LINK "AIRCLIC.NYC.FRESHDIRECT.COM"
CONNECT TO AIRCLIC_RO
IDENTIFIED BY "<pwd>"
using 'airclic';


CREATE OR REPLACE VIEW TRANSP.ASSETSTATUS AS SELECT * FROM airclic_prod.assetstatus@AIRCLIC.NYC.FRESHDIRECT.COM;

CREATE OR REPLACE VIEW TRANSP.ASSETTRACKING AS SELECT * FROM airclic_prod.assetstatus@AIRCLIC.NYC.FRESHDIRECT.COM;

CREATE OR REPLACE VIEW TRANSP.PUNCHINFO AS SELECT * FROM dbo.FDDW_TIMESHTPUNCHV42@MSSQLDSNPROD.NYC.FRESHDIRECT.COM;


GRANT SELECT ON  TRANSP.ASSETSTATUS TO FDSTORE_PRDA;

GRANT SELECT ON  TRANSP.ASSETSTATUS TO FDSTORE_PRDB;

GRANT SELECT ON  TRANSP.ASSETSTATUS TO FDTRN_PRDA;

GRANT SELECT ON  TRANSP.ASSETSTATUS TO APPDEV;

GRANT SELECT ON  TRANSP.ASSETTRACKING TO FDSTORE_PRDA;

GRANT SELECT ON  TRANSP.ASSETTRACKING TO FDSTORE_PRDB;

GRANT SELECT ON  TRANSP.ASSETTRACKING TO FDTRN_PRDA;

GRANT SELECT ON  TRANSP.ASSETTRACKING TO APPDEV;

GRANT SELECT ON  TRANSP.PUNCHINFO TO FDSTORE_PRDA;

GRANT SELECT ON  TRANSP.PUNCHINFO TO FDSTORE_PRDB;

GRANT SELECT ON  TRANSP.PUNCHINFO TO FDTRN_PRDA;

GRANT SELECT ON  TRANSP.PUNCHINFO TO APPDEV;



CREATE TABLE TRANSP.ACTIVITY_LOG
(
  LOG_ID      VARCHAR2(10 BYTE)                 NOT NULL,
  USER_ID     VARCHAR2(20 BYTE)                 NOT NULL,
  LOG_DATE    DATE                              NOT NULL,
  TYPE        INTEGER                           NOT NULL,
  TYPE_ID     VARCHAR2(10 BYTE),
  FIELD_NAME  VARCHAR2(40 BYTE),
  OLD_VALUE   VARCHAR2(100 BYTE),
  NEW_VALUE   VARCHAR2(100 BYTE),
  PRIMARY KEY
 (LOG_ID)
);


CREATE UNIQUE INDEX TRANSP.LOG_INDEX ON TRANSP.ACTIVITY_LOG
(LOG_ID, USER_ID, LOG_DATE, TYPE);


CREATE SEQUENCE TRANSP.LOGSEQ
  START WITH 1
  MAXVALUE 999999999999999999999999999
  MINVALUE 0
  NOCYCLE
  CACHE 20
  NOORDER;
  
GRANT SELECT ON  TRANSP.ACTIVITY_LOG TO FDSTORE_PRDA;

GRANT SELECT ON  TRANSP.ACTIVITY_LOG TO FDSTORE_PRDB;

GRANT SELECT ON  TRANSP.ACTIVITY_LOG TO APPDEV;

GRANT ALTER, DELETE, INDEX, INSERT, REFERENCES, SELECT, UPDATE, ON COMMIT REFRESH, QUERY REWRITE, DEBUG ON  TRANSP.ACTIVITY_LOG TO FDTRN_PRDA;

GRANT ALTER, SELECT ON  TRANSP.LOGSEQ TO FDMKT_PRDA;

GRANT ALTER, SELECT ON  TRANSP.LOGSEQ TO FDSTORE_PRDB;

GRANT ALTER, SELECT ON  TRANSP.LOGSEQ TO APPDEV;

GRANT ALTER, SELECT ON  TRANSP.LOGSEQ TO FDTRN_PRDA;
  
ALTER TABLE TRANSP.ZONE ADD PRIORITY INTEGER;


UPDATE transp.ZONE SET priority =CAST (ZONE_CODE AS INTEGER);
=>expected result is 93 rows updated.


ALTER TABLE TRANSP.DISPATCH  ADD (

  GPS_NO          VARCHAR2(50 BYTE),
  EZPASS_NO       VARCHAR2(50 BYTE),
  DISPATCH_TIME   DATE,
  PHONE_ASSIGNED  CHAR(1 BYTE),
  KEYS_READY      CHAR(1 BYTE),
  CHECKEDIN_TIME  DATE
);