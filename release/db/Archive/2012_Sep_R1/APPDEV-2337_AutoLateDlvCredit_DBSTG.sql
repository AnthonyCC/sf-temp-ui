DROP VIEW DLV.CARTONSTATUS;

CREATE OR REPLACE FORCE VIEW DLV.CARTONSTATUS
(
   SCANDATE,
   WEBORDERNUM,
   CARTONID,
   ACTION,
   CARTONSTATUS,
   EMPLOYEE,
   ROUTE,
   STOP,
   WINDOW,
   NEXTELID,
   USERID,
   EVENTID,
   INSERT_TIMESTAMP
)
AS
   SELECT scandate,
          webordernum,
          cartonid,
          action,
          cartonstatus,
          employee,
          route,
          stop,
		  window,
          nextelid,
          userid,
          eventid,
          insert_timestamp
     FROM ac_stagetrain.cartonstatus@AIRCLICRW.NYC.FRESHDIRECT.COM
/

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE, ON COMMIT REFRESH, QUERY REWRITE, DEBUG, FLASHBACK ON DLV.CARTONSTATUS TO FDSTORE_STSTG01;

GRANT SELECT on DLV.CARTONSTATUS TO APPDEV;

create table cust.AUTO_LATE_DELIVERY (
	ID VARCHAR2(16) PRIMARY KEY,
	ORDER_DATE DATE,
	STATUS VARCHAR2(1),
	APPROVED_BY VARCHAR2(30)
)
/

CREATE TABLE CUST.AUTO_LATE_DELIVERY_ORDERS (
	AUTO_LATE_DELIVERY_ID VARCHAR2(16),
	SALE_ID VARCHAR2(16),
	CUSTOMER_ID VARCHAR2(16),
	REM_AMOUNT NUMBER(10,2),
	REM_TYPE VARCHAR2(1),
	ORIGINAL_AMOUNT NUMBER(10,2),
	TAX_AMOUNT NUMBER(10,2),
	TAX_RATE NUMBER(6,5),
	DLV_PASS_ID VARCHAR2(16),
	COMPLAINT_CODE VARCHAR2(8),
	STATUS VARCHAR2(1),
	CONSTRAINT DLV_ORDERS PRIMARY KEY(AUTO_LATE_DELIVERY_ID,SALE_ID)
)
/

CREATE TABLE LATE_DLV_COMPLAINT_CODES (
	COMP_CODE VARCHAR2(8)
)
/	


GRANT DELETE, INSERT, SELECT, UPDATE on CUST.AUTO_LATE_DELIVERY TO FDSTORE_STSTG01;

GRANT SELECT on CUST.AUTO_LATE_DELIVERY TO APPDEV;

GRANT DELETE, INSERT, SELECT, UPDATE on CUST.AUTO_LATE_DELIVERY_ORDERS TO FDSTORE_STSTG01;

GRANT SELECT on CUST.AUTO_LATE_DELIVERY_ORDERS TO APPDEV;

GRANT DELETE, INSERT, SELECT, UPDATE on CUST.LATE_DLV_COMPLAINT_CODES TO FDSTORE_STSTG01;

GRANT SELECT on CUST.LATE_DLV_COMPLAINT_CODES TO APPDEV;

insert into CUST.COMPLAINT_CODE (CODE, NAME, SUBJECT_CODE, PRIORITY) Values ('CUSTLATE', 'Customer Lates', 'LDQ-015', 25);

insert into cust.complaint_dept_code select 'CUSTLATE', 'GDW', 10, null, cust.system_seq.nextval from dual;

insert into CUST.COMPLAINT_CODE (CODE, NAME, SUBJECT_CODE, PRIORITY) Values ('DLVLATE', 'Delivery Lates', 'LDQ-016', 25);

insert into cust.complaint_dept_code select 'DLVLATE', 'GDW', 10, null, cust.system_seq.nextval from dual;

insert into CUST.COMPLAINT_CODE (CODE, NAME, SUBJECT_CODE, PRIORITY) Values ('DRVRLATE', 'Driver Lates', 'LDQ-017', 25);

insert into cust.complaint_dept_code select 'DRVRLATE', 'GDW', 10, null, cust.system_seq.nextval from dual;

insert into CUST.COMPLAINT_CODE (CODE, NAME, SUBJECT_CODE, PRIORITY) Values ('SCANLATE', 'Scan Lates', 'LDQ-018', 25);

insert into cust.complaint_dept_code select 'SCANLATE', 'GDW', 10, null, cust.system_seq.nextval from dual;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'LATEDL0' FROM DUAL;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'LATEDL30' FROM DUAL;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'LATEDL60' FROM DUAL;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'LATEDL90' FROM DUAL;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'LATEDEL' FROM DUAL;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'CUSTLATE' FROM DUAL;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'DLVLATE' FROM DUAL;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'SCANLATE' FROM DUAL;

INSERT INTO CUST.LATE_DLV_COMPLAINT_CODES SELECT 'DRVRLATE' FROM DUAL;

commit;