<%@ include file='/common/i_calendar.jspf'%> 
<script>

      var crisisMngReportPanel;
      var jsonrpcClient = new JSONRpcClient("crisismanage.ax");
	var errColor = "#FF0000";
	var msgColor = "#00FF00";
	var _currentBatchId;
	var _reportType;
      function init() {
        crisisMngReportPanel = new YAHOO.widget.Panel("crisisMngReportPanel-1", {
                          width: "350px", 
                          fixedcenter: true, 
                          close: true, 
                          draggable: false, 
                          zindex:4,
                          modal: true,
                          visible: false,
                          effect:{effect:YAHOO.widget.ContainerEffect.SLIDE,duration:0.25}});
	}

     function showCrisisMngReportForm(inputVal, reportType) {
          addSysMessage("", false);
         _currentBatchId = inputVal;
	 _reportType = reportType;
	  crisisMngReportPanel.render(document.body);
          crisisMngReportPanel.show();
     }
             
      function submitCrisisMngReportForm() {

    	  var _regularData = YAHOO.util.Dom.get("regular").value;
	  var _standingOrderData = YAHOO.util.Dom.get("standingOrder").value;
		if(_reportType == 'MKR'){
			location.href = 'marketingreport.do?batchId='+_currentBatchId+'&regularOrderKey='+_regularData+'&standingOrderKey='+_standingOrderData;
		} else{
			location.href = 'voiceshotreport.do?batchId='+_currentBatchId+'&regularOrderKey='+_regularData+'&standingOrderKey='+_standingOrderData;
		}
	 
      }
      
      function addSysMessage(msg, isError) {
      		var errContObj = YAHOO.util.Dom.get("errContainer");
		    if(isError) {
		    	errContObj.style.color = errColor;
	      	} else {
	      		errContObj.style.color = msgColor;
	      	}
	      	errContObj.style.fontWeight="bold";
      		YAHOO.util.Dom.get("errContainer").innerHTML = msg;
      }
      
      function assetAttributeFormCallback(result, exception) {
      	  
          if(exception) {               
              alert('Unable to connect to host system. Please contact system administrator!');
              return;
          }
          if(result) {
          	addSysMessage("", false);
          	crisisMngReportPanel.hide();
          	location.href = location.href;
          }else {
          	addSysMessage("", true);
          }                           
      }
      
      function hideForm() { 
      	  YAHOO.util.Dom.get("errContainer").value = "";
		document.getElementById("regular").checked=false;
		document.getElementById("standingOrder").checked=false;
		document.getElementById("All").checked=false;

      	  crisisMngReportPanel.hide();
      }
      
      YAHOO.util.Event.addListener(window, "load", init);
      YAHOO.util.Event.addListener(window, "unload", hideForm);

      function changeEvent(){

	 if(document.getElementById("All").checked){
		document.getElementById("regular").checked=true;
		document.getElementById("standingOrder").checked=true;
	 }else{
		document.getElementById("regular").checked=false;
		document.getElementById("standingOrder").checked=false;
	 }
      }
    </script>
   
  <div style='display:none;height:0px;width:0px;'>
      <div id="crisisMngReportPanel-1">
      <div class="hd"><img src="images/icons/edit_ON.gif" width="16" height="16" border="0" align="absmiddle" />&nbsp;&nbsp;&nbsp;Choose Crisis Manager Report Data</div>
      <div class="bd">
      	<div id="errContainer"></div>
      	<div style="background-color:#D7C8FF">
	      	<table class="forms1">
		      	<tr>
				<td>
					<input type="checkbox" size="30" name="All" id="All" value="" onClick="javascript:changeEvent();">&nbsp;&nbsp;All&nbsp;</input>
					<input type="checkbox" size="30" name="regular" id="regular" value="O" >&nbsp;&nbsp;Regular</input>
					<input type="checkbox" size="30" name="standingOrder" id="standingOrder" value="SO" >&nbsp;&nbsp;Standing Order</input>
				</td>
			</tr>
		      	 <tr>
		                <td align="center"><input type="button" value="Submit" onclick="javascript:submitCrisisMngReportForm()" /> </td>
		         </tr>
		      </table>
	      </div>      
        </div>
    </div>
    </div>