<?xml version="1.0"?>
<!DOCTYPE ejb-jar PUBLIC "-//Sun Microsystems, Inc.//DTD Enterprise JavaBeans 1.1//EN" "http://java.sun.com/j2ee/dtds/ejb-jar_1_1.dtd">

<!-- Created by knadeem on August 1, 2001, 8:44 PM -->

<ejb-jar>
    <enterprise-beans>

        
        <entity>
        	<ejb-name>DlvDepot</ejb-name>
        	<home>com.freshdirect.delivery.depot.ejb.DlvDepotHome</home>
        	<remote>com.freshdirect.delivery.depot.ejb.DlvDepotEB</remote>
        	<ejb-class>com.freshdirect.delivery.depot.ejb.DlvDepotEntityBean</ejb-class>
        	<persistence-type>Bean</persistence-type>
        	<prim-key-class>com.freshdirect.framework.core.PrimaryKey</prim-key-class>
        	<reentrant>False</reentrant>
        	<resource-ref>
        		<res-ref-name>jdbc/dbpool</res-ref-name>
        		<res-type>javax.sql.DataSource</res-type>
        		<res-auth>Container</res-auth>
        	</resource-ref>
        </entity>

        <session>
        	<ejb-name>SessionAuditor</ejb-name>
        	<home>com.freshdirect.delivery.audit.ejb.SessionAuditorHome</home>
        	<remote>com.freshdirect.delivery.audit.ejb.SessionAuditorSB</remote>
        	<ejb-class>com.freshdirect.delivery.audit.ejb.SessionAuditorSessionBean</ejb-class>
            <session-type>Stateless</session-type>
            <transaction-type>Container</transaction-type>
        	<resource-ref>
        		<res-ref-name>jdbc/dbpool</res-ref-name>
        		<res-type>javax.sql.DataSource</res-type>
        		<res-auth>Container</res-auth>
        	</resource-ref>
        </session>

		<session>
            <ejb-name>DlvManager</ejb-name>
            <home>com.freshdirect.delivery.ejb.DlvManagerHome</home>
            <remote>com.freshdirect.delivery.ejb.DlvManagerSB</remote>
            <ejb-class>com.freshdirect.delivery.ejb.DlvManagerSessionBean</ejb-class>
            <session-type>Stateless</session-type>
            <transaction-type>Container</transaction-type>
            <resource-ref>
                <res-ref-name>jdbc/dbpool</res-ref-name>
                <res-type>javax.sql.DataSource</res-type>
                <res-auth>Container</res-auth>
            </resource-ref>
        </session>
        
        <session>
            <ejb-name>DlvRestrictionManager</ejb-name>
            <home>com.freshdirect.delivery.ejb.DlvRestrictionManagerHome</home>
            <remote>com.freshdirect.delivery.ejb.DlvRestrictionManagerSB</remote>
            <ejb-class>com.freshdirect.delivery.ejb.DlvRestrictionManagerSessionBean</ejb-class>
            <session-type>Stateless</session-type>
            <transaction-type>Container</transaction-type>
            <resource-ref>
                <res-ref-name>jdbc/dbpool</res-ref-name>
                <res-type>javax.sql.DataSource</res-type>
                <res-auth>Container</res-auth>
            </resource-ref>
        </session>
        
        
        <session>
            <ejb-name>DlvAdminManager</ejb-name>
            <home>com.freshdirect.delivery.admin.ejb.DlvAdminManagerHome</home>
            <remote>com.freshdirect.delivery.admin.ejb.DlvAdminManagerSB</remote>
            <ejb-class>com.freshdirect.delivery.admin.ejb.DlvAdminManagerSessionBean</ejb-class>
            <session-type>Stateless</session-type>
            <transaction-type>Container</transaction-type>
            <resource-ref>
                <res-ref-name>jdbc/dbpool</res-ref-name>
                <res-type>javax.sql.DataSource</res-type>
                <res-auth>Container</res-auth>
            </resource-ref>
        </session>

		<session>
            <ejb-name>DlvTemplateManager</ejb-name>
            <home>com.freshdirect.delivery.ejb.DlvTemplateManagerHome</home>
            <remote>com.freshdirect.delivery.ejb.DlvTemplateManagerSB</remote>
            <ejb-class>com.freshdirect.delivery.ejb.DlvTemplateManagerSessionBean</ejb-class>
            <session-type>Stateless</session-type>
            <transaction-type>Container</transaction-type>
            <resource-ref>
                <res-ref-name>jdbc/dbpool</res-ref-name>
                <res-type>javax.sql.DataSource</res-type>
                <res-auth>Container</res-auth>
            </resource-ref>
        </session>
        
        <session>
            <ejb-name>DlvDepotManager</ejb-name>
            <home>com.freshdirect.delivery.depot.ejb.DlvDepotManagerHome</home>
            <remote>com.freshdirect.delivery.depot.ejb.DlvDepotManagerSB</remote>
            <ejb-class>com.freshdirect.delivery.depot.ejb.DlvDepotManagerSessionBean</ejb-class>
            <session-type>Stateless</session-type>
            <transaction-type>Container</transaction-type>
            <resource-ref>
                <res-ref-name>jdbc/dbpool</res-ref-name>
                <res-type>javax.sql.DataSource</res-type>
                <res-auth>Container</res-auth>
            </resource-ref>
        </session>
        
        <session>
            <ejb-name>DlvMapper</ejb-name>
            <home>com.freshdirect.delivery.map.ejb.DlvMapperHome</home>
            <remote>com.freshdirect.delivery.map.ejb.DlvMapperSB</remote>
            <ejb-class>com.freshdirect.delivery.map.ejb.DlvMapperSessionBean</ejb-class>
            <session-type>Stateless</session-type>
            <transaction-type>Container</transaction-type>
            <resource-ref>
                <res-ref-name>jdbc/dbpool</res-ref-name>
                <res-type>javax.sql.DataSource</res-type>
                <res-auth>Container</res-auth>
            </resource-ref>
        </session>
        
        <session>
            <ejb-name>RoutingGateway</ejb-name>
            <home>com.freshdirect.delivery.routing.ejb.RoutingGatewayHome</home>
            <remote>com.freshdirect.delivery.routing.ejb.RoutingGatewaySB</remote>
            <ejb-class>com.freshdirect.delivery.routing.ejb.RoutingGatewaySessionBean</ejb-class>
            <session-type>Stateless</session-type>
            <transaction-type>Container</transaction-type>
            <resource-ref>
                <res-ref-name>jms/QueueFactory</res-ref-name>
                <res-type>javax.jms.QueueConnectionFactory</res-type>
                <res-auth>Container</res-auth>
            </resource-ref>
            <resource-env-ref>
                <resource-env-ref-name>jms/Queue</resource-env-ref-name>
                <resource-env-ref-type>javax.jms.Queue</resource-env-ref-type>
            </resource-env-ref>
        </session>
         <message-driven>
            <ejb-name>RoutingLoadListener</ejb-name>
            <ejb-class>com.freshdirect.delivery.routing.ejb.RoutingLoadListener</ejb-class>
            <transaction-type>Container</transaction-type>
            <message-selector>(MessageType='ROUTINGADDRESS/process' OR MessageType='GET_TIMESLOT' OR MessageType='RESERVE_TIMESLOT' OR MessageType='CANCEL_TIMESLOT' OR MessageType='CONFIRM_TIMESLOT')</message-selector>
            <message-driven-destination>
                <destination-type>javax.jms.Queue</destination-type>
            </message-driven-destination>
        </message-driven>
    </enterprise-beans>

    <assembly-descriptor>
    	 <container-transaction>
            <method>
                <ejb-name>DlvDepot</ejb-name>
                <method-name>*</method-name>
            </method>
            <trans-attribute>Supports</trans-attribute>
        </container-transaction>

        <container-transaction>
        	<method>
				<ejb-name>DlvTemplateManager</ejb-name>
				<method-name>*</method-name>
			</method>
			<method>
				<ejb-name>DlvManager</ejb-name>
				<method-name>*</method-name>
			</method>
			<method>
				<ejb-name>DlvRestrictionManager</ejb-name>
				<method-name>*</method-name>
			</method>
			<method>
				<ejb-name>SessionAuditor</ejb-name>
				<method-name>*</method-name>
			</method>
			<method>
				<ejb-name>DlvAdminManager</ejb-name>
				<method-name>*</method-name>
			</method>
			<method>
				<ejb-name>DlvDepotManager</ejb-name>
				<method-name>*</method-name>
			</method>
			<method>
				<ejb-name>DlvMapper</ejb-name>
				<method-name>*</method-name>
			</method>
            <method>
                <ejb-name>RoutingGateway</ejb-name>
                <method-intf>Remote</method-intf>
                <method-name>*</method-name>
            </method>
            <method>
            <ejb-name>RoutingLoadListener</ejb-name>
            <method-name>*</method-name>
          </method>
			<trans-attribute>Required</trans-attribute>
        </container-transaction>
        
        <container-transaction>
        	<method>
				<ejb-name>DlvManager</ejb-name>
				<method-name>makeRecurringReservation</method-name>
			</method>
			<trans-attribute>RequiresNew</trans-attribute>
        </container-transaction>
    </assembly-descriptor>
</ejb-jar>
