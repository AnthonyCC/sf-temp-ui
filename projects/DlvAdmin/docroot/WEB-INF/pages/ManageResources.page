<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE page-specification PUBLIC
  "-//Apache Software Foundation//Tapestry Specification 4.0//EN"
  "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">
<!-- generated by Spindle, http://spindle.sourceforge.net -->


<page-specification class="com.freshdirect.dlvadmin.ManageResources">

    <property name="selectedRegion" persist="session"/>
    <property name="selectedZone" persist="session"/>
    <property name="selectedWeek" persist="session"/>
    <property name="dailyResources" persist="session"/>

    <property name="currentResource"/>
    <property name="currentTruckType"/>
    <property name="currentDay"/>
    
    <bean name="capacityFormDelegate" class="org.apache.tapestry.valid.ValidationDelegate" lifecycle="request"/>
    <bean name="doubleValidator" class="org.apache.tapestry.valid.NumberValidator" lifecycle="request">
        <set name="minimum" value='0.0'/>
        <set name="maximum" value='@java.lang.Double@MAX_VALUE'/>
    </bean>
    <bean name="intValidator" class="org.apache.tapestry.valid.NumberValidator" lifecycle="request">
        <set name="minimum" value='0'/>
        <set name="maximum" value='@java.lang.Integer@MAX_VALUE'/>
    </bean>

    <component id="border" type="Border"/>

    <component id="forEachDate" type="Foreach">
        <binding name="source" value='ognl:days'/>
        <binding name="value" value='ognl:currentDay'/>
    </component>

    <component id="forEachResource" type="Foreach">
        <binding name="source" value='dailyResources[currentDay]'/>
        <binding name="value" value='currentResource'/>
    </component>

    <component id="forEachTimeslot" type="Foreach">
        <binding name="source" value='currentResource.timeslots'/>
    </component>

    <component id="forEachTruck" type="Foreach">
        <binding name="source" value='@com.freshdirect.delivery.EnumTruckType@getEnumList()'/>
        <binding name="value" value='currentTruckType'/>
    </component>

    <component id="formCapacity" type="Form">
        <binding name="delegate" value='beans.capacityFormDelegate'/>
        <binding name="direct" value='false'/>
        <binding name="stateful" value='false'/>
    </component>

    <component id="formRegion" type="Form">
        <binding name="listener" value='listeners.selectRegion'/>
        <binding name="stateful" value='false'/>
    </component>

    <component id="formWeek" type="Form">
        <binding name="listener" value='listeners.selectWeek'/>
        <binding name="stateful" value='false'/>
    </component>

    <component id="formZone" type="Form">
        <binding name="listener" value='listeners.selectZone'/>
        <binding name="stateful" value='false'/>
    </component>

    <component id="ifRegionSelected" type="Conditional">
        <binding name="condition" value='selectedRegion!=null'/>
    </component>

    <component id="ifRegionTimeSelected" type="Conditional">
        <binding name="condition" value='selectedRegion!=null &amp;&amp; selectedWeek!=null'/>
    </component>

    <component id="ifZoneSelected" type="Conditional">
        <binding name="condition" value='selectedZone != null'/>
    </component>

    <component id="inputCapacity" type="TextField">
        <binding name="value" value='components.forEachTimeslot.value.capacity'/>
    </component>

    <component id="inputDeliveryRate" type="ValidField">
        <binding name="displayName" value="literal:Delivery Rate"/>
        <binding name="validator" value='beans.doubleValidator'/>
        <binding name="value" value='currentResource.deliveryRate'/>
    </component>

    <component id="inputDrivers" type="ValidField">
        <binding name="displayName" value="literal:Drivers"/>
        <binding name="validator" value='beans.intValidator'/>
        <binding name="value" value='currentResource.people'/>
    </component>

    <component id="inputTrafficFactor" type="TextField">
        <binding name="value" value='components.forEachTimeslot.value.trafficFactor'/>
    </component>

    <component id="inputTruckCapacity" type="ValidField">
        <binding name="displayName" value="literal:'Truck Capacity'"/>
        <binding name="validator" value='beans.intValidator'/>
        <binding name="value" value='currentTruckAllocation.capacity'/>
    </component>

    <component id="inputTruckCount" type="ValidField">
        <binding name="displayName" value="Truck Count"/>
        <binding name="validator" value='beans.intValidator'/>
        <binding name="value" value='currentTruckAllocation.count'/>
    </component>

    <component id="insertDate" type="Insert">
        <binding name="format" value='dateFormatter'/>
        <binding name="value" value='currentDay'/>
    </component>

    <component id="insertRegionName" type="Insert">
        <binding name="value" value='selectedRegion.name'/>
    </component>

    <component id="insertShiftEndTime" type="Insert">
        <binding name="value" value='currentResource.end'/>
    </component>

    <component id="insertShiftName" type="Insert">
        <binding name="value" value='currentResource.name'/>
    </component>

    <component id="insertShiftName2" copy-of="insertShiftName"/>

    <component id="insertShiftStartTime" type="Insert">
        <binding name="value" value='currentResource.start'/>
    </component>

    <component id="insertTimeslotEndTime" type="Insert">
        <binding name="value" value='components.forEachTimeslot.value.endTime'/>
    </component>

    <component id="insertTimeslotStartTime" type="Insert">
        <binding name="value" value='components.forEachTimeslot.value.startTime'/>
    </component>
    
    <component id="insertTimeslotRoutingEndTime" type="Insert">
        <binding name="value" value='components.forEachTimeslot.value.routingEndTime'/>
    </component>

    <component id="insertTimeslotRoutingStartTime" type="Insert">
        <binding name="value" value='components.forEachTimeslot.value.routingStartTime'/>
    </component>

    <component id="insertWeek" type="Insert">
        <binding name="value" value='selectedWeek'/>
    </component>

    <component id="insertZoneName" type="Insert">
        <binding name="value" value='selectedZone'/>
    </component>

    <component id="selectRegion" type="PropertySelection">
        <binding name="model" value='engine.regionSelectionModel'/>
        <binding name="submitOnChange" value='true'/>
        <binding name="value" value='selectedRegion'/>
    </component>

    <component id="selectWeek" type="PropertySelection">
        <binding name="model" value='weekSelectionModel'/>
        <binding name="submitOnChange" value='true'/>
        <binding name="value" value='selectedWeek'/>
    </component>

    <component id="selectZone" type="PropertySelection">
        <binding name="model" value='getZoneSelectionModel()'/>
        <binding name="submitOnChange" value='true'/>
        <binding name="value" value='selectedZone'/>
    </component>

    <component id="submitCapacities" type="Submit">
        <binding name="listener" value='listeners.updateCapacities'/>
    </component>

</page-specification>
