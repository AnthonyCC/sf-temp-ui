<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE page-specification PUBLIC
  "-//Apache Software Foundation//Tapestry Specification 3.0//EN"
  "http://jakarta.apache.org/tapestry/dtd/Tapestry_3_0.dtd">
<!-- generated by Spindle, http://spindle.sourceforge.net -->


<page-specification class="com.freshdirect.dlvadmin.EditPlan">

	<property-specification name="plan" persistent="yes"/>
	<property-specification name="editShift" persistent="yes"/>
	<property-specification name="shiftNumber" persistent="yes"/>

    <component id="border" type="Border"/>

    <component id="editShift" type="EditShift">
        <binding name="cancelListener" expression='listeners.cancelEditShift'/>
        <binding name="label" expression='(shiftNumber==null) ? "Add" : "OK"'/>
        <binding name="listener" expression='(shiftNumber==null) ? listeners.submitAddShift : listeners.submitEditShift'/>
        <binding name="shift" expression='editShift'/>
    </component>

    <component id="addShift" copy-of="editShift"/>

    <component id="editTimeslots" type="EditTimeslots">
        <binding name="listener" expression='listeners.submitEditTimeslots'/>
        <binding name="shift" expression='editShift'/>
    </component>

    <component id="forEachDay" type="Foreach">
        <binding name="source" expression='@com.freshdirect.delivery.EnumDayCode@getEnumList()'/>
    </component>

    <component id="forEachShift" type="Foreach">
        <binding name="source" expression='plan.getShiftsForDay(components.forEachDay.value)'/>
        <binding name="value" expression='currentShift'/>
    </component>

    <component id="forEachTimeslot" type="Foreach">
        <binding name="source" expression='currentShift.timeslotsByStartDate'/>
    </component>

    <component id="ifShowAddButton" type="Conditional">
        <binding name="condition" expression='(editShift!=null) &amp;&amp; (shiftNumber==null) &amp;&amp; (editShift.dayOfWeek==components.forEachDay.value)'/>
        <binding name="invert" expression='true'/>
    </component>

    <component id="ifShowAddShift" type="Conditional">
        <binding name="condition" expression='(editShift!=null) &amp;&amp; (shiftNumber==null) &amp;&amp; (editShift.dayOfWeek==components.forEachDay.value)'/>
    </component>

    <component id="ifShowEditShift" type="Conditional">
        <binding name="condition" expression='(editShift!=null) &amp;&amp; (shiftNumber==components.forEachShift.index) &amp;&amp; (editShift.dayOfWeek==components.forEachDay.value)'/>
    </component>

    <component id="ifShowShift" type="Conditional">
        <binding name="condition" expression='(editShift!=null) &amp;&amp; (shiftNumber==components.forEachShift.index) &amp;&amp; (editShift.dayOfWeek==components.forEachDay.value)'/>
        <binding name="invert" expression='true'/>
    </component>

    <component id="insertPlanName" type="Insert">
        <binding name="value" expression='plan.name'/>
    </component>
    
    <component id="insertDay" type="Insert">
        <binding name="value" expression='components.forEachDay.value.name'/>
    </component>

    <component id="insertEndTime" type="Insert">
        <binding name="value" expression='currentShift.end'/>
    </component>

    <component id="insertShiftName" type="Insert">
        <binding name="value" expression='currentShift.name'/>
    </component>

    <component id="insertStartTime" type="Insert">
        <binding name="value" expression='currentShift.start'/>
    </component>

    <component id="insertTimeslotCutoffTime" type="Insert">
        <binding name="value" expression='components.forEachTimeslot.value.cutoffTime'/>
    </component>

    <component id="insertTimeslotEndTime" type="Insert">
        <binding name="value" expression='components.forEachTimeslot.value.endTime'/>
    </component>

    <component id="insertTimeslotStartTime" type="Insert">
        <binding name="value" expression='components.forEachTimeslot.value.startTime'/>
    </component>

    <component id="insertTimeslotStatus" type="Insert">
        <binding name="value" expression='components.forEachTimeslot.value.status.name'/>
    </component>

    <component id="linkAddShift" type="DirectLink">
        <binding name="listener" expression='listeners.addShift'/>
        <binding name="parameters" expression='components.forEachDay.value.value'/>
    </component>

    <component id="linkDeleteShift" type="DirectLink">
        <binding name="listener" expression='listeners.deleteShift'/>
        <binding name="parameters" expression='{ components.forEachDay.value, components.forEachShift.index }'/>
    </component>

    <component id="linkEditShift" type="DirectLink">
        <binding name="listener" expression='listeners.editShift'/>
        <binding name="parameters" expression='{ components.forEachDay.value, components.forEachShift.index }'/>
    </component>

    <component id="linkUpdatePlan" type="DirectLink">
        <binding name="listener" expression='listeners.updatePlan'/>
    </component>

</page-specification>
