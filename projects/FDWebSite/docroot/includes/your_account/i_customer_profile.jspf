
<%@page import="com.freshdirect.fdstore.survey.FDSurvey"%>
<%@page import="com.freshdirect.fdstore.survey.FDSurveyCachedFactory"%>
<%@page import="com.freshdirect.fdstore.survey.EnumSurveyType"%>
<%@page import="com.freshdirect.fdstore.survey.FDSurveyResponse"%>
<%@page import="com.freshdirect.fdstore.customer.FDCustomerManager"%>
<%@page import="java.util.List"%>
<%@page import="com.freshdirect.fdstore.customer.FDUserI"%>
<%@page import="com.freshdirect.webapp.taglib.fdstore.SessionName"%>
<%@page import="com.freshdirect.fdstore.survey.SurveyHtmlHelper"%>
<%@page import="com.freshdirect.fdstore.survey.EnumFormDisplayType"%><script type="text/javascript">
	/*
	 *	this probably isn't a good idea usabilty-wise
	 *
	*/
	function clearSection(pId, isChecked){
		var store = pId+'store';
		if (isChecked)
		{
			/* checking none */
			/* if not stored, create store */
			if (!window[store])
			{
				window[store] = new Array();
			}
			/* grab all inputs to store and then clear them  */
			var selections = (document.getElementById(pId)).getElementsByTagName('input');
			for (var n=0; n < (selections.length-1); n++) {
				switch (selections[n].type)
				{
					case 'radio':
					case 'checkbox' :
						window[store][n] = selections[n].checked;
						selections[n].checked = false;
						selections[n].disabled = true;
						break;
					case 'text' :
						window[store][n] = selections[n].value;
						selections[n].value = '';
						selections[n].disabled = true;
						break;
				
				}
			}
		}else{
			/* unchecking none */
			/* grab all selections */
			var selections = (document.getElementById(pId)).getElementsByTagName('input');
			/* check if stored already */
			if (window[store])
			{
				/* replace them */
				for (var n=0; n < (selections.length-1); n++) {
					switch (selections[n].type)
					{
					case 'radio':
					case 'checkbox' :
							selections[n].disabled = false;
							selections[n].checked = window[store][n];
							break;
						case 'text' :
							selections[n].disabled = false;
							selections[n].value = window[store][n];
							break;
					
					}
				}
			}
		}
	}
	/* if we don't want the values, just disabling would be the way to go */
	function disableForNone(pId, noneVal){
		if(document.getElementById(pId)) {
			var inputs = (document.getElementById(pId)).getElementsByTagName('input');
		}else{ return false; }

		/* check if we're dealing with radio buttons. if so, toggle the noneVal  */
		if ((inputs[inputs.length-1].disabled || inputs[0].disabled) && inputs[0].type=='radio') {
			(noneVal) ? noneVal = false : noneVal = true;
		}
		for (var n=0; n < inputs.length; n++) {
			if (inputs[n].className.indexOf('none_choice') < 0)
			{
				/* disable all but the none choice */
				(noneVal) ? inputs[n].disabled = true :	inputs[n].disabled = false;
			}else{
				/* toggle the none choice */
				(noneVal) ? inputs[n].checked = true : inputs[n].checked = false;
			}
		}
	}
</script>
<style>
	body { font-family:Verdana,Arial,sans-serif; font-size: 10px; height: 100%; }
	.container {width: 700px;}
    .container1 {width: 630px;}
	.ctext { text-align: left; margin: 10px 2px; font-size: 11px; }
	.etext { text-align: left; margin: 10px 20px; font-size: 11px; font-weight: bold; }
	.notes { text-align: left; margin: 10px 20px; font-size: 10px; font-weight: normal; }
	.example { border: 1px dashed #4c4; width: 703px; text-align: left; margin: 5px auto 5px auto; }
	.fleft { float: left; }
	.cleft { clear: left; }
	.cright { clear: right; }
	.cboth { clear: both; }
	.question { color: orange; font-size: 12px; font-weight: bold; padding-top:10px; padding-bottom:3px; }
	.question_number { float: left; width: 25px; }
	.question_text { float: left; width: 675px; }
	.answer { margin: 10px; }
	.other { padding-left: 32px; }

	.q02_container { float: left; margin: 0 10px 0 0; }
	.q02_input { float: left; padding: 1px; }
	.q02_input input { font-size: 11px; text-align: center; width: 30px; }
	.q02_incr { float: left; }
	.q02_incr div { height: 8px; width: 10px; padding: 1px; }
	.q02_incr div img { height: 9px; width: 10px; margin: 0 2px; }
	.q02_text { float: left; line-height: 22px; padding-left: 4px; }

	.q03_container { float: left; margin: 0 10px 0 0; }

	.q04_container { float: left; margin: 0 10px 0 0; width: 48%; line-height: 22px; }
	.q04_container div { clear: right; }
	.q04_container input { float: left; }
	.q04_container div div { float: right; width: 90%; line-height: 22px; }

	.q05_container { float: left; margin: 0; line-height: 23px; }
	.q05_col50per { width: 50%; }
	.q05_col25per { width: 25%; }
	.q05_col75per { width: 75%; }
	.q05_container div { line-height: 24px; }
	.q05_container div div { float: left; padding-right: 10px; line-height: 22px; width: 22px; }
	.q05_container .other_input { font-size: 11px; text-align: left; width: 100px; margin: 2px 10px 1px 3px; }

	.q06_container { font-weight: bold;}
	.q06_container span { font-weight: bold; }
	.q06_container select { margin-left: 10px; }

	.q07_container { margin: 0 10px 0 0; width: 100%; line-height: 22px; }
	.q07_container div { padding: 1px 0; line-height: 22px; }
	.q07_container div div { clear: left; float: left; padding-right: 3px; }
    .q07_container .other_input { font-size: 11px; text-align: left; width: 100px; margin: 2px 10px 1px 3px; }
	//.q07_container .other_input { font-size: 11px; text-align: left; width: 100px; margin-left: 10px; }

	// q08 - to eat / to cook
	.q08_container { margin: 0 10px 0 0; width: 80%; line-height: 22px;}
	//.q08_container .q08_text { clear: both; }
	.q08_text { float: left; padding: 1px 0; padding-left:10px; line-height: 22px; width: 200px; }
	.q08_cb { float: right; padding: 1px 0; line-height: 22px; width: 70px; text-align: center; font-weight: bold;}
	
	.q09_container { float: left; width: 30%; padding:10px; }
	.q09_container .box { width: 100%; }
	.leftB { border-left:solid 1px #CCCCCC; border-top:solid 1px #CCCCCC;}
	.middleB { border:solid 1px #CCCCCC; border-bottom:none; }
	.rightB { border-right:solid 1px #CCCCCC; border-top:solid 1px #CCCCCC;}
	.leftBL { border:solid 1px #CCCCCC; border-right: none;}
	.middleBL { border:solid 1px #CCCCCC; }
	.rightBL {  border:solid 1px #CCCCCC; border-left: none;}
	.q09_container div div { line-height: 22px; }
	.q09_rb { float: left; width: 35%; text-align: right; }
	.q09_text { float: left; width: 65%; text-align: left; }
	//.odd { background-color: #ddd;  line-height: 26px; height: 26px;}
	//.even { background-color: #aaa;  line-height: 26px; height: 26px;}

	.q10_container { float: left; width: 600px; }
	.q10_container div { margin: 5px 0; }
	.q10_container select { margin: 0 10px 0 0; width: 97%; }
	
	.q11_container { margin: 0 10px 0 0; line-height: 22px; }
	.q11_colfright { float: right; }
	.q11_col35per { width: 35%; }
	.q11_col65per { width: 65%; }
	.q11_col65per div { width: 50%; }
	.q11_container div { float: left; padding: 1px 0; line-height: 22px; }
	.other_input { font-size: 11px; text-align: left; width: 100px; margin-left: 10px; }

	.q12_container { float: left; padding: 1px;}
	.q12_container input { margin: 5px; padding-top:8px; }
	.rb_image { text-align: center; width: 110px; }

	.q13_container {width:100%; align:center;}
	.q14_container {width:700px; align:center;}
	.q15_container { margin: 0 10px 0 0; width: 100%; line-height: 22px; }

	/* below is the table styles */
	.tQuestion { color: orange; font-size: 12px; font-weight: bold; width: 100%; border: 0; text-align: left; border-collapse: collapse; line-height: 24px; }
	.tQuestion td { vertical-align: top; }
	td.tIndex { width: 20px; }
	.tAnswer { padding: 6px 0 10px 10px; width: 100%; border-spacing: 0px; border-collapse: collapse; line-height: 24px; }
	.tAnswer td { padding: 0; }
	.tAnswer table { float: left; line-height: 24px; }
	.incr_input { font-size: 11px; text-align: center; width: 30px; }
	.col25per { width: 25%; }
	.col33per { width: 33.3%; }	
	.col49per { width: 49%; }
	.col50per { width: 50%; }
	.col75per { width: 75%; }
	.col100per { width: 100%; }
	.leftBorder { border-left: solid 3px #FFFFFF;}
	.other { padding: 0 0 0 24px; }
	.odd { background-color: #eee; }
	.even { background-color: #fff; }
	.bolded { font-weight: bold; }
	.cbHead { width: 10%; text-align: center; font-weight: bold; }
	.other_input { font-size: 11px; text-align: left; width: 100px; margin-left: 10px; }
	.tLeft { text-align: left; }
	.tCen { text-align: center; }
	.pad10px { padding: 10px; }
	.padTop30px { padding-top: 30px; }
	.rb_image { text-align: center; width: 110px; }
	.surveyText {font-family:Verdana,Arial,sans-serif; font-size: 10px;}

</style>
<% int quesCount = 1; 
       String _survey_Name=request.getAttribute("Survey").toString();
       FDSurvey Usability = FDSurveyCachedFactory.getSurvey(EnumSurveyType.getEnum(request.getAttribute("Survey").toString()));
       request.removeAttribute("Survey");
       FDUserI _user = (FDUserI)session.getAttribute(SessionName.USER);
       FDSurveyResponse surveyResponse= FDCustomerManager.getCustomerProfileSurveyInfo(_user.getIdentity());
       List questions = Usability.getQuestions();
       String questionPostFix=" (Choose one)";
       List previousAnswers=null;
       
    %>
    <% if(EnumSurveyType.POST_ORDER_SURVEY.equals(EnumSurveyType.getEnum(_survey_Name))) {%>
        <div class="container1">
    <% } else {%>
        <div class="container">
    <%}%>
	
	    <logic:iterate id="question" collection="<%= questions %>" type="com.freshdirect.fdstore.survey.FDSurveyQuestion" indexId='index'>
        
            <% 
				String input = "radio";
				String surveyQuestion = "text13";
                if(question.isMultiselect())input = "checkbox";
                if(surveyResponse!=null && surveyResponse.getAnswer(question.getName())!=null) {
                    previousAnswers=surveyResponse.getAnswerAsList(question.getName());
                } else {
                   previousAnswers=null;
                }
				//boolean tableRestrict = false;
				//boolean multiSelection = false;
            %>
            <fd:ErrorHandler result='<%=result%>' name='<%=question.getName()%>'>
                    <% surveyQuestion = "text13rbold"; %>
            </fd:ErrorHandler>
				<%=quesCount!=1?"<br>":""%>
			    <div class="question"><a name="<%=question.getName()%>"></a><%=quesCount%>. <%=SurveyHtmlHelper.getQuestionText(question)%></div>
                    <% String container="q07_container";
                       if(EnumFormDisplayType.DISPLAY_PULLDOWN_GROUP.equals(question.getFormDisplayType())){
                            container="q06_container";
                       }else if(question.isPulldown()) {
                            container="q10_container";
                       } else if(EnumFormDisplayType.TWO_ANS_PER_ROW.equals(question.getFormDisplayType())) {
                            container="answer_container";
                       } else if(EnumFormDisplayType.GROUPED_MULTI_SELECTION.equals(question.getFormDisplayType())){
                            container="q8_container";
							//tableRestrict = true;
							//multiSelection = true;
						} else if(EnumFormDisplayType.IMAGE_DISPLAY.equals(question.getFormDisplayType())) {
							container="q13_container";
                       } else if(EnumFormDisplayType.GROUPED_RADIO_BUTTON.equals(question.getFormDisplayType())) {
					   		container="q14_container";
					   }
						//if (("q07_container").equals(container)) {tableRestrict = true;}
                     %>
                     <%-- if (tableRestrict) { %><table cellpadding="0" cellspacing="0" border="0" <%=multiSelection?"width=\"450\"":""%>><tr><td><%} --%>
				        <div class="<%=container%>" id="<%=quesCount%>" style="font-size:10px;">
                              <%=SurveyHtmlHelper.getAnswersHtml(String.valueOf(quesCount),question,previousAnswers)%>            
				        </div>
					<%-- if (tableRestrict) { %></td></tr></table><%} --%>

                <%quesCount++;%>
				
                <div class="cboth"><!--  --></div>
                
		</logic:iterate>
</div>
