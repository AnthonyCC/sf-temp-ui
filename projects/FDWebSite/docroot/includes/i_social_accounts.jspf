

	<script type="text/javascript">
		jQuery.noConflict();
		

				
		jQuery(document).ready(function() {			
			
			//$('#disconnect_social_accounts_facebook').click(function(){  		//********  NOT WORKING since '$' has been set to $jq in 'i_javascripts.jspf'. 
			jQuery("#disconnect_social_accounts_facebook").click(function(){			
				/*  
				 * reset form fields with hidden field value
				 */
				var userTokenFacebook = jQuery("#user_token_facebook").val();
				var socialEmailFacebook = jQuery("#socialEmail_facebook").val();
				
				jQuery("#socialNetworkProvider").val("facebook");  
				jQuery("#socialEmail").val(socialEmailFacebook);
				jQuery("#userToken").val(userTokenFacebook);  				
			});
			
			
			jQuery("#disconnect_social_accounts_google").click(function(){							
				/*  
				 * reset form fields with hidden field value
				 */
				var userTokenGoogle = jQuery("#user_token_google").val();   							
				var socialEmailGoogle = jQuery("#socialEmail_google").val();
				
				jQuery("#socialNetworkProvider").val("google"); 
				jQuery("#socialEmail").val(socialEmailGoogle);  
				jQuery("#userToken").val(userTokenGoogle);  				
			});			
					
		});
	</script>
		

				

	

	<form name="social_accounts" method="post">
	
		<!-- hidden fields used to pass value to RegistrationControllerTag -->
		<input type="hidden" name="actionName" value="disconnectSocialAccount">   
		<input type="hidden" id="userToken" name="userToken" value="">   
		<input type="hidden" id="socialEmail" name="socialEmail" value="">   
		
		<tr>
			<td colspan="6"><br><br>
				<img src="/media_stat/images/navigation/social_accounts/Social_Accounts.png" width="130" height="16" border="0" alt="SOCIAL ACCOUNTS"><br>
				<img src="/media_stat/images/layout/cccccc.gif" width="<%= W_YA_SIGNIN_INFO %>" height="1" border="0" vspace="5"><br>								
			</td>
		</tr>
		
		
		<%		
			
		%>
				
		
		
		
		<%		
			List<ErpCustomerSocialLoginModel> socialLoginInfo = cm.getSocialLoginInfo();
		
			boolean connectedWithFacebook = false;
			boolean connectedWithGoogle = false;
			String socialNetworkProvider = "";
			
			// variables for 'google' accounts
			String user_token_google = "";
			String socialEmail_google = "";
			
			// variables for 'facebook' accounts
			String user_token_facebook = "";	
			String socialEmail_facebook = "";
			
			if(socialLoginInfo != null && socialLoginInfo.size()>0){				
				for(ErpCustomerSocialLoginModel socialLoginModel : socialLoginInfo ){					
					String provider = socialLoginModel.getProvider();					
					if(provider != null && provider.length()>0 && provider.equalsIgnoreCase("facebook")){							
						connectedWithFacebook = true;
						user_token_facebook = socialLoginModel.getUser_token();
						socialEmail_facebook = socialLoginModel.getUser_id();
						socialNetworkProvider = "facebook";						
					} else if(provider != null && provider.length()>0 && provider.equalsIgnoreCase("google")){						
						connectedWithGoogle = true;
						user_token_google = socialLoginModel.getUser_token();	
						socialEmail_google = socialLoginModel.getUser_id();
						socialNetworkProvider = "google";
					}					
				}
			}
		
			//=================================================================================================================================================================================================
			String subdomain = "freshdirect";
			//String provider_key = "facebook";
			String service = "social_login";
			String callback_uri = request.getScheme() + "://" + request.getServerName() + ":" + request.getServerPort()+"/social/social_link_success.jsp";
		
			//String directConnectUrl = "https://" + subdomain + ".api.oneall.com/socialize/connect/direct/" + socialNetworkProvider + "/";
			String directConnectUrl = "https://" + subdomain + ".api.oneall.com/socialize/connect/direct";
			
			// https://freshdirect.api.oneall.com/socialize/connect/direct/facebook/?service=social_login&callback_uri=http%3A%2F%2Flocalhost%3A7001%2Fsocial%2Fsocial_login_success.jsp			
			//String forwardUrl = "https://freshdirect.api.oneall.com/socialize/connect/direct/facebook/?service=social_login&callback_uri=http%3A%2F%2Flocalhost%3A7001%2Fsocial%2Fsocial_login_success.jsp";
			
			String forwardUrl = directConnectUrl + "?service=" + service + "&callback_uri=" + callback_uri;  // not used
			//=================================================================================================================================================================================================
			
	
			
			if(connectedWithFacebook){			
		%>		
				<tr>
					<td colspan="6">
						<img src="/media_stat/images/navigation/social_accounts/FacebookShort.png" width="42" height="22" border="0" alt="FACEBOOK SHORT"> You are connected to Facebook. 
						<input type="image" id="disconnect_social_accounts_facebook" name="disconnect_social_accounts_facebook" src="/media_stat/images/navigation/social_accounts/Disconnect.png" width="62" height="12"  alt="DISCONNECT">
					</td>									
				</tr>				
		<%	} else { %>		
				<tr>
					<td colspan="6">													
						<img src="/media_stat/images/navigation/social_accounts/ConnectFacebook.png" width="200" height="36" border="0" alt="CONNECT WITH FACEBOOK"
											 onclick="window.open('/social/social_link.jsp?forwardPage=<%=directConnectUrl %>/facebook/&callback_uri=<%=callback_uri%>&service=<%=service %>', '', 'resizable')"	> 							 							 
					</td>
				</tr>			
		<%	} %>	
		
		
		<tr>
			<td><img src="/media_stat/images/layout/clear.gif" width="40" height="8" border="0" alt=""></td>
		</tr>			
		
		<%	
			if(connectedWithGoogle){			
		%>		
				<tr>
					<td colspan="6">
						<img src="/media_stat/images/navigation/social_accounts/GoogleShort.png" width="42" height="22" border="0" alt="GOOGLE SHORT"> You are connected to Google. 
						<input type="image" id="disconnect_social_accounts_google" name="disconnect_social_accounts_google" src="/media_stat/images/navigation/social_accounts/Disconnect.png" width="62" height="12"  alt="DISCONNECT">						
					</td>
				</tr>				
		<%	} else { %>		
				<tr>
					<td colspan="6">													 
						<img src="/media_stat/images/navigation/social_accounts/ConnectGoogle.png" width="200" height="36" border="0" alt="CONNECT WITH GOOGLE"
											 onclick="window.open('/social/social_link.jsp?forwardPage=<%=directConnectUrl %>/google/&callback_uri=<%=callback_uri%>&service=<%=service %>', '', 'resizable')"	> 							 
					</td>
				</tr>			
		<%	} %>		
		
		
		<!-- hidden fields used to pass java variables to jQuery -->
		<input type="hidden" id="socialNetworkProvider" name="socialNetworkProvider" value="">   		
		<input type="hidden" id="user_token_facebook" name="user_token_facebook" value="<%=user_token_facebook%>">   
		<input type="hidden" id="socialEmail_facebook" name="socialEmail_facebook" value="<%=socialEmail_facebook%>">   		
		<input type="hidden" id="user_token_google" name="user_token_google" value="<%=user_token_google%>">   
		<input type="hidden" id="socialEmail_google" name="socialEmail_google" value="<%=socialEmail_google%>">


	</form>	
	

<br>
<br>
<br>
<br>



	